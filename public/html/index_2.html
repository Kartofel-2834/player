<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>My Player</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/file?path=css/style.css">
  </head>
  <body>
    <div id="app">

      <menu>

      </menu>

      <div class="player space_between align">

        <div :class="[ { 'hide_opacity': !player.track }, 'track_info', 'row', 'align', 'third_of_player']">
          <img class="poster" :src="player.track ? `/file?path=posters/${ player.track._id }.jpg` : ''">

          <div class="track_title_and_author">
            <h1 style="max-width:90%" :class="{ marquee: player.track && player.track.title.length > 25 }" >
              <span>{{ player.track ? player.track.title : '' }}</span>
            </h1>

            <h2 style="max-width:90%" :class="{ marquee: player.track && player.track.author.length > 35 }" >
              <span>{{ player.track ? player.track.author : '' }}</span>
            </h2>
          </div>
        </div>


        <div class="player_controllers space_between column third_of_player">

          <div class="main_player_buttons_inner row align">
            <div class="button skip_song_button" @click="previousSong" style="transform:scale(-0.8, 0.8)"></div>
            <div :class="playPauseButtonClasses" @click="playPause"></div>
            <div class="button skip_song_button" @click="nextSong"></div>
          </div>

          <div class="track_time space_between align">
            <div class="time">{{ trackTimeParse( song.currentTime ) }}</div>

            <div class="current_time_changer grid_layout_inner range_input_inner" >
              <div :style="{ width: player.playProgress + '%' }" class="range_progress_fiction grid_layout_element"></div>
              <input type="range"
                @input="controllingTimeLine"
                @mouseup="timeLineControlOff"
                @mousedown="timeLineControlOn"
                class="grid_layout_element"
                min="0"
                :value="player.playProgress * 1000 - 200"
                max="100000"
              >
            </div>

            <div class="time">{{ trackTimeParse( song.duration ) }}</div>
          </div>

        </div>

        <div class="secondary_player_buttons_inner center third_of_player">
          <div class="row align">
            <div :class="[
                'button',
                'secondary_player_button',
                {
                  'restart_button': !player.repeatSong,
                  'restart_button_active': player.repeatSong
                }
              ]"
              @click="repeatButtonEvent"
            ></div>
            <div :class="[
                'button',
                'secondary_player_button',
                {
                  'random_button': !player.randomModeActive,
                  'random_button_active': player.randomModeActive
                },
              ]"
              @click="randomButtonEvent"
            ></div>

            <div class="row align">
              <div
                :class="{
                  button: true,
                  mute_button: player.songVolume == 0 || player.songMuted,
                  volume_button: player.songVolume > 0 && !player.songMuted,
                }"
                @click="mute"
              >
              </div>

              <div class="range_input_inner grid_layout_inner volume_changer">
                <div :style="{ width: player.songVolume + '%' }" class="range_progress_fiction grid_layout_element" ></div>
                <input type="range" @input="changeVolume" class="grid_layout_element" min="0" value="100" max="100">
              </div>
            </div>

          </div>

        </div>

      </div>

      <ol class="track_list column align" >

        <li
          v-for="i in player.playList.length"
          :class="[
            'track_link', 'space_between', 'align',
            { track_link_active: player.track && player.playList[i-1]._id == player.track._id },
          ]"
          @click="changeTrack( player.playList[i-1], i-1 )"
        >
          <div class="track_link_info row align">
            <img
              :style="{ boxShadow: player.track && player.playList[i-1]._id == player.track._id ? '0px 0px 17px 2px rgb(34 60 80 / 20%)' : 'none' }"
              class="link_poster"
              :src=" '/file?path=posters/' + player.playList[i-1]._id + '.jpg' "
            >

            <div class="track_title_and_author" style="margin-left: 1.5rem">
              <h1 style="font-size:1.3em" >{{ player.playList[i-1].title }}</h1>
              <h2>{{ player.playList[i-1].author }}</h2>
            </div>
          </div>

          <div class="">
            <div class="track_menu_open_button"></div>
            <div :class="{
              ball: player.track && player.playList[i-1]._id == player.track._id,
              hide: player.track && player.playList[i-1]._id != player.track._id,
              play_ball: !song.paused,
              pause_ball: song.paused,
            }"></div>
          </div>

        </li>

      </ol>

    </div>

    <script src="https://unpkg.com/vue@next"></script>
    <script type="text/javascript" src="/file?path=js/script.js"></script>
  </body>
</html>
